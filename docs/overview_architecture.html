
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Swift Architectural Overview · Swift Docs - Swift 官方文档阅读 by Donald Tsang(圆月弯刀)</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Donald Tsang（圆月弯刀）">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-page-toc-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-back-to-top-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-prism/prism-ghcolors.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-lightbox/lightbox.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="overview_rings.html" />
    
    
    <link rel="prev" href="api/object_api_v1_overview.html" />
    

    
        <link rel="shortcut icon" href='../favicon.ico' type="image/x-icon">
    
    
        <link rel="bookmark" href='../favicon.ico' type="image/x-icon">
    
    
    

    <style>
    @media only screen and (max-width: 640px) {
        .book-header .hidden-mobile {
            display: none;
        }
    }
    </style>
    <script>
        window["gitbook-plugin-github-buttons"] = {"repo":"eiuapp/swift-docs","types":["star"],"size":"small"};
    </script>

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://b.qqbb.app" target="_blank" class="custom-link">Donald Tsang</a>
        </li>
    
        
        <li>
            <a href="https://eiu.app/swift-docs" target="_blank" class="custom-link">Swift Docs</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        <li class="header">序言</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                        <b>1.1.</b>
                    
                    前言
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">环境配置</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="env.html">
            
                <a href="env.html">
            
                    
                        <b>2.1.</b>
                    
                    swift 2.17 环境配置
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">index</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="./">
            
                <a href="./">
            
                    
                        <b>3.1.</b>
                    
                    Index
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="getting_started.html">
            
                <a href="getting_started.html">
            
                    
                        <b>3.2.</b>
                    
                    Getting Started
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Overview and Concepts¶</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="api/object_api_v1_overview.html">
            
                <a href="api/object_api_v1_overview.html">
            
                    
                        <b>4.1.</b>
                    
                    Object Storage API overview
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="4.2" data-path="overview_architecture.html">
            
                <a href="overview_architecture.html">
            
                    
                        <b>4.2.</b>
                    
                    Swift Architectural Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="overview_rings.html">
            
                <a href="overview_rings.html">
            
                    
                        <b>4.3.</b>
                    
                    The Rings
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="overview_policies.html">
            
                <a href="overview_policies.html">
            
                    
                        <b>4.4.</b>
                    
                    Storage Policies
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="overview_reaper.html">
            
                <a href="overview_reaper.html">
            
                    
                        <b>4.5.</b>
                    
                    The Account Reaper
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="../overview_auth.html">
            
                <span>
            
                    
                        <b>4.6.</b>
                    
                    The Auth System
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.7" data-path="../overview_acl.html">
            
                <span>
            
                    
                        <b>4.7.</b>
                    
                    Access Control Lists (ACLs)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.8" data-path="../overview_replication.html">
            
                <span>
            
                    
                        <b>4.8.</b>
                    
                    Replication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.9" data-path="../ratelimit.html">
            
                <span>
            
                    
                        <b>4.9.</b>
                    
                    Rate Limiting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.10" data-path="../overview_large_objects.html">
            
                <span>
            
                    
                        <b>4.10.</b>
                    
                    Large Object Support
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.11" data-path="../overview_object_versioning.html">
            
                <span>
            
                    
                        <b>4.11.</b>
                    
                    Object Versioning
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.12" data-path="../overview_global_cluster.html">
            
                <span>
            
                    
                        <b>4.12.</b>
                    
                    Global Clusters
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.13" data-path="../overview_container_sync.html">
            
                <span>
            
                    
                        <b>4.13.</b>
                    
                    Container to Container Synchronization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.14" data-path="../overview_expiring_objects.html">
            
                <span>
            
                    
                        <b>4.14.</b>
                    
                    Expiring Object Support
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.15" data-path="../cors.html">
            
                <span>
            
                    
                        <b>4.15.</b>
                    
                    CORS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.16" data-path="../crossdomain.html">
            
                <span>
            
                    
                        <b>4.16.</b>
                    
                    Cross-domain Policy File
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.17" data-path="../overview_erasure_code.html">
            
                <span>
            
                    
                        <b>4.17.</b>
                    
                    Erasure Code Support
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.18" data-path="../overview_encryption.html">
            
                <span>
            
                    
                        <b>4.18.</b>
                    
                    Object Encryption
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.19" data-path="../overview_backing_store.html">
            
                <span>
            
                    
                        <b>4.19.</b>
                    
                    Using Swift as Backing Store for Service Data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.20" data-path="../ring_background.html">
            
                <span>
            
                    
                        <b>4.20.</b>
                    
                    Building a Consistent Hashing Ring
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.21" data-path="../ring_partpower.html">
            
                <span>
            
                    
                        <b>4.21.</b>
                    
                    Modifying Ring Partition Power
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.22" data-path="../associated_projects.html">
            
                <span>
            
                    
                        <b>4.22.</b>
                    
                    Associated Projects
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Developer Documentation¶</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../development_guidelines.html">
            
                <span>
            
                    
                        <b>5.1.</b>
                    
                    Development Guidelines
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../development_saio.html">
            
                <span>
            
                    
                        <b>5.2.</b>
                    
                    SAIO - Swift All In One
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="../first_contribution_swift.html">
            
                <span>
            
                    
                        <b>5.3.</b>
                    
                    First Contribution to Swift
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="../policies_saio.html">
            
                <span>
            
                    
                        <b>5.4.</b>
                    
                    Adding Storage Policies to an Existing SAIO
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.5" data-path="../development_auth.html">
            
                <span>
            
                    
                        <b>5.5.</b>
                    
                    Auth Server and Middleware
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.6" data-path="../development_middleware.html">
            
                <span>
            
                    
                        <b>5.6.</b>
                    
                    Middleware and Metadata
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.7" data-path="../development_ondisk_backends.html">
            
                <span>
            
                    
                        <b>5.7.</b>
                    
                    Pluggable On-Disk Back-end APIs
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Administrator Documentation¶</li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../howto_installmultinode.html">
            
                <span>
            
                    
                        <b>6.1.</b>
                    
                    Instructions for a Multiple Server Swift Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="../deployment_guide.html">
            
                <span>
            
                    
                        <b>6.2.</b>
                    
                    Deployment Guide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="../apache_deployment_guide.html">
            
                <span>
            
                    
                        <b>6.3.</b>
                    
                    Apache Deployment Guide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.4" data-path="../admin_guide.html">
            
                <span>
            
                    
                        <b>6.4.</b>
                    
                    Administrator’s Guide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.5" data-path="../replication_network.html">
            
                <span>
            
                    
                        <b>6.5.</b>
                    
                    Dedicated replication network
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.6" data-path="../logs.html">
            
                <span>
            
                    
                        <b>6.6.</b>
                    
                    Logs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.7" data-path="../ops_runbook/index.html">
            
                <span>
            
                    
                        <b>6.7.</b>
                    
                    Swift Ops Runbook
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.8" data-path="../admin/index.html">
            
                <span>
            
                    
                        <b>6.8.</b>
                    
                    OpenStack Swift Administrator Guide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.9" data-path="../install/index.html">
            
                <span>
            
                    
                        <b>6.9.</b>
                    
                    Object Storage Install Guide
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Object Storage v1 REST API Documentation¶</li>
        
        
    
        <li class="chapter " data-level="7.1" data-path="../api/object_api_v1_overview.html">
            
                <span>
            
                    
                        <b>7.1.</b>
                    
                    Object Storage API overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="../api/discoverability.html">
            
                <span>
            
                    
                        <b>7.2.</b>
                    
                    Discoverability
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.3" data-path="../api/authentication.html">
            
                <span>
            
                    
                        <b>7.3.</b>
                    
                    Authentication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.4" data-path="../api/container_quotas.html">
            
                <span>
            
                    
                        <b>7.4.</b>
                    
                    Container quotas
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.5" data-path="../api/object_versioning.html">
            
                <span>
            
                    
                        <b>7.5.</b>
                    
                    Object versioning
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.6" data-path="../api/large_objects.html">
            
                <span>
            
                    
                        <b>7.6.</b>
                    
                    Large objects
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.7" data-path="../api/temporary_url_middleware.html">
            
                <span>
            
                    
                        <b>7.7.</b>
                    
                    Temporary URL middleware
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.8" data-path="../api/form_post_middleware.html">
            
                <span>
            
                    
                        <b>7.8.</b>
                    
                    Form POST middleware
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.9" data-path="../api/use_content-encoding_metadata.html">
            
                <span>
            
                    
                        <b>7.9.</b>
                    
                    Use Content-Encoding metadata
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.10" data-path="../api/use_the_content-disposition_metadata.html">
            
                <span>
            
                    
                        <b>7.10.</b>
                    
                    Use the Content-Disposition metadata
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">OpenStack End User Guide¶</li>
        
        
    

    
        
        <li class="header">Source Documentation¶</li>
        
        
    
        <li class="chapter " data-level="9.1" data-path="../ring.html">
            
                <span>
            
                    
                        <b>9.1.</b>
                    
                    Partitioned Consistent Hash Ring
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.1" data-path="../ring.html">
            
                <span>
            
                    
                        <b>9.1.1.</b>
                    
                    Ring
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.2" data-path="../ring.html">
            
                <span>
            
                    
                        <b>9.1.2.</b>
                    
                    Ring Builder
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.1.3" data-path="../ring.html">
            
                <span>
            
                    
                        <b>9.1.3.</b>
                    
                    Composite Ring Builder
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.2" data-path="../proxy.html">
            
                <span>
            
                    
                        <b>9.2.</b>
                    
                    Proxy
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.2.1" data-path="../proxy.html">
            
                <span>
            
                    
                        <b>9.2.1.</b>
                    
                    Proxy Controllers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.2.2" data-path="../proxy.html">
            
                <span>
            
                    
                        <b>9.2.2.</b>
                    
                    Proxy Server
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.3" data-path="../account.html">
            
                <span>
            
                    
                        <b>9.3.</b>
                    
                    Account
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.3.1" data-path="../account.html">
            
                <span>
            
                    
                        <b>9.3.1.</b>
                    
                    Account Auditor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.3.2" data-path="../account.html">
            
                <span>
            
                    
                        <b>9.3.2.</b>
                    
                    Account Backend
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.3.3" data-path="../account.html">
            
                <span>
            
                    
                        <b>9.3.3.</b>
                    
                    Account Reaper
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.3.4" data-path="../account.html">
            
                <span>
            
                    
                        <b>9.3.4.</b>
                    
                    Account Server
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.4" data-path="../container.html">
            
                <span>
            
                    
                        <b>9.4.</b>
                    
                    Container
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.4.1" data-path="../container.html">
            
                <span>
            
                    
                        <b>9.4.1.</b>
                    
                    Container Auditor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.4.2" data-path="../container.html">
            
                <span>
            
                    
                        <b>9.4.2.</b>
                    
                    Container Backend
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.4.3" data-path="../container.html">
            
                <span>
            
                    
                        <b>9.4.3.</b>
                    
                    Container Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.4.4" data-path="../container.html">
            
                <span>
            
                    
                        <b>9.4.4.</b>
                    
                    Container Reconciler
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.4.5" data-path="../container.html">
            
                <span>
            
                    
                        <b>9.4.5.</b>
                    
                    Container Replicator
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.4.6" data-path="../container.html">
            
                <span>
            
                    
                        <b>9.4.6.</b>
                    
                    Container Sync
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.4.7" data-path="../container.html">
            
                <span>
            
                    
                        <b>9.4.7.</b>
                    
                    Container Updater
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.5" data-path="../db.html">
            
                <span>
            
                    
                        <b>9.5.</b>
                    
                    Account DB and Container DB
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.5.1" data-path="../db.html">
            
                <span>
            
                    
                        <b>9.5.1.</b>
                    
                    DB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.5.2" data-path="../db.html">
            
                <span>
            
                    
                        <b>9.5.2.</b>
                    
                    DB replicator
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.6" data-path="../object.html">
            
                <span>
            
                    
                        <b>9.6.</b>
                    
                    Object
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.6.1" data-path="../object.html">
            
                <span>
            
                    
                        <b>9.6.1.</b>
                    
                    Object Auditor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.6.2" data-path="../object.html">
            
                <span>
            
                    
                        <b>9.6.2.</b>
                    
                    Object Backend
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.6.3" data-path="../object.html">
            
                <span>
            
                    
                        <b>9.6.3.</b>
                    
                    Object Replicator
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.6.4" data-path="../object.html">
            
                <span>
            
                    
                        <b>9.6.4.</b>
                    
                    Object Reconstructor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.6.5" data-path="../object.html">
            
                <span>
            
                    
                        <b>9.6.5.</b>
                    
                    Object Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.6.6" data-path="../object.html">
            
                <span>
            
                    
                        <b>9.6.6.</b>
                    
                    Object Updater
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.7" data-path="../misc.html">
            
                <span>
            
                    
                        <b>9.7.</b>
                    
                    Misc
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.7.1" data-path="../misc.html">
            
                <span>
            
                    
                        <b>9.7.1.</b>
                    
                    ACLs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.7.2" data-path="../misc.html">
            
                <span>
            
                    
                        <b>9.7.2.</b>
                    
                    Buffered HTTP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.7.3" data-path="../misc.html">
            
                <span>
            
                    
                        <b>9.7.3.</b>
                    
                    Constraints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.7.4" data-path="../misc.html">
            
                <span>
            
                    
                        <b>9.7.4.</b>
                    
                    Container Sync Realms
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.7.5" data-path="../misc.html">
            
                <span>
            
                    
                        <b>9.7.5.</b>
                    
                    Direct Client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.7.6" data-path="../misc.html">
            
                <span>
            
                    
                        <b>9.7.6.</b>
                    
                    Exceptions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.7.7" data-path="../misc.html">
            
                <span>
            
                    
                        <b>9.7.7.</b>
                    
                    Internal Client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.7.8" data-path="../misc.html">
            
                <span>
            
                    
                        <b>9.7.8.</b>
                    
                    Manager
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.7.9" data-path="../misc.html">
            
                <span>
            
                    
                        <b>9.7.9.</b>
                    
                    MemCacheD
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.7.10" data-path="../misc.html">
            
                <span>
            
                    
                        <b>9.7.10.</b>
                    
                    Request Helpers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.7.11" data-path="../misc.html">
            
                <span>
            
                    
                        <b>9.7.11.</b>
                    
                    Swob
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.7.12" data-path="../misc.html">
            
                <span>
            
                    
                        <b>9.7.12.</b>
                    
                    Utils
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.7.13" data-path="../misc.html">
            
                <span>
            
                    
                        <b>9.7.13.</b>
                    
                    WSGI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.7.14" data-path="../misc.html">
            
                <span>
            
                    
                        <b>9.7.14.</b>
                    
                    Storage Policy
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9.8" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.</b>
                    
                    Middleware
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.8.1" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.1.</b>
                    
                    Account Quotas
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.2" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.2.</b>
                    
                    Bulk Operations (Delete and Archive Auto Extraction)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.3" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.3.</b>
                    
                    CatchErrors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.4" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.4.</b>
                    
                    CNAME Lookup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.5" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.5.</b>
                    
                    Container Quotas
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.6" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.6.</b>
                    
                    Container Sync Middleware
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.7" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.7.</b>
                    
                    Cross Domain Policies
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.8" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.8.</b>
                    
                    Discoverability
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.9" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.9.</b>
                    
                    Domain Remap
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.10" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.10.</b>
                    
                    Dynamic Large Objects
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.11" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.11.</b>
                    
                    Encryption
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.12" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.12.</b>
                    
                    FormPost
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.13" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.13.</b>
                    
                    GateKeeper
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.14" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.14.</b>
                    
                    Healthcheck
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.15" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.15.</b>
                    
                    Keymaster
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.16" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.16.</b>
                    
                    KeystoneAuth
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.17" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.17.</b>
                    
                    List Endpoints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.18" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.18.</b>
                    
                    Memcache
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.19" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.19.</b>
                    
                    Name Check (Forbidden Character Filter)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.20" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.20.</b>
                    
                    Object Versioning
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.21" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.21.</b>
                    
                    Proxy Logging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.22" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.22.</b>
                    
                    Ratelimit
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.23" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.23.</b>
                    
                    Recon
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.24" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.24.</b>
                    
                    Server Side Copy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.25" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.25.</b>
                    
                    Static Large Objects
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.26" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.26.</b>
                    
                    StaticWeb
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.27" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.27.</b>
                    
                    Symlink
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.28" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.28.</b>
                    
                    TempAuth
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.29" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.29.</b>
                    
                    TempURL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="9.8.30" data-path="../middleware.html">
            
                <span>
            
                    
                        <b>9.8.30.</b>
                    
                    XProfile
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Indices and tables¶</li>
        
        
    
        <li class="chapter " data-level="10.1" data-path="../genindex.html">
            
                <span>
            
                    
                        <b>10.1.</b>
                    
                    Index
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.2" data-path="../py-modindex.html">
            
                <span>
            
                    
                        <b>10.2.</b>
                    
                    Module Index
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.3" data-path="../search.html">
            
                <span>
            
                    
                        <b>10.3.</b>
                    
                    Search Page
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">未来</li>
        
        
    
        <li class="chapter " data-level="11.1" >
            
                <a target="_blank" href="https://b.qqbb.app/tags/swift/">
            
                    
                        <b>11.1.</b>
                    
                    我的swift探险之旅
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="11.2" >
            
                <a target="_blank" href="https://eiuapp/swift-handbook/">
            
                    
                        <b>11.2.</b>
                    
                    Swift Handbook
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">相关资源</li>
        
        
    
        <li class="chapter " data-level="12.1" data-path="tech_resource.html">
            
                <a href="tech_resource.html">
            
                    
                        <b>12.1.</b>
                    
                    swift技术工具与资源
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Swift Architectural Overview</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <html><head></head><body><h2 id="swift-architectural-overview">Swift Architectural Overview</h2>
<p>updated: 2019-02-14 02:34</p>
<h1 id="swift-architectural-overview&#xB6;">Swift Architectural Overview<a href="#swift-architectural-overview" title="Permalink to this headline">&#xB6;</a></h1>
<h2 id="proxy-server&#xB6;">Proxy Server<a href="#proxy-server" title="Permalink to this headline">&#xB6;</a></h2>
<p>The Proxy Server is responsible for tying together the rest of the Swift architecture. For each request, it will look up the location of the account, container, or object in the ring (see below) and route the request accordingly. For Erasure Code type policies, the Proxy Server is also responsible for encoding and decoding object data. See <a href="overview_erasure_code.html">Erasure Code Support</a> for complete information on Erasure Code support. The public API is also exposed through the Proxy Server.</p>
<p>&#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5668;(Proxy Server)&#x8D1F;&#x8D23;&#x5C06;Swift&#x67B6;&#x6784;&#x7684;&#x5176;&#x4F59;&#x90E8;&#x5206;&#x6346;&#x7ED1;&#x5728;&#x4E00;&#x8D77;&#x3002;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x8BF7;&#x6C42;&#xFF0C;&#x5B83;&#x5C06;&#x67E5;&#x627E;&#x73AF;&#x4E2D;&#x7684;&#x5E10;&#x6237;&#xFF0C;&#x5BB9;&#x5668;&#x6216;&#x5BF9;&#x8C61;&#x7684;&#x4F4D;&#x7F6E;&#xFF08;&#x53C2;&#x89C1;&#x4E0B;&#x6587;&#xFF09;&#x5E76;&#x76F8;&#x5E94;&#x5730;&#x8DEF;&#x7531;&#x8BF7;&#x6C42;&#x3002;&#x5BF9;&#x4E8E;Erasure Code&#x7C7B;&#x578B;&#x7B56;&#x7565;&#xFF0C;Proxy Server&#x8FD8;&#x8D1F;&#x8D23;&#x7F16;&#x7801;&#x548C;&#x89E3;&#x7801;&#x5BF9;&#x8C61;&#x6570;&#x636E;&#x3002;&#x6709;&#x5173;Erasure Code&#x652F;&#x6301;&#x7684;&#x5B8C;&#x6574;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;<a href="overview_erasure_code.html">Erasure Code Support</a>&#x3002;&#x516C;&#x5171;API&#x4E5F;&#x901A;&#x8FC7;&#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5668;&#x516C;&#x5F00;&#x3002;</p>
<p>A large number of failures are also handled in the Proxy Server. For example, if a server is unavailable for an object PUT, it will ask the ring for a handoff server and route there instead.</p>
<p>&#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5668;&#x4E2D;&#x4E5F;&#x5904;&#x7406;&#x4E86;&#x5927;&#x91CF;&#x6545;&#x969C;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x670D;&#x52A1;&#x5668;&#x4E0D;&#x53EF;&#x7528;&#x4E8E;&#x5BF9;&#x8C61;PUT&#x64CD;&#x4F5C;&#xFF0C;&#x5B83;&#x5C06;&#x5411;&#x73AF;&#x8BF7;&#x6C42;&#x5207;&#x6362;&#x670D;&#x52A1;&#x5668;&#x5E76;&#x5728;&#x90A3;&#x91CC;&#x8DEF;&#x7531;&#x3002;</p>
<p>When objects are streamed to or from an object server, they are streamed directly through the proxy server to or from the user &#x2013; the proxy server does not spool them.</p>
<p>&#x5F53;&#x5BF9;&#x8C61;&#x6D41;&#x5F0F;&#x4F20;&#x8F93;&#x5230;&#x5BF9;&#x8C61;&#x670D;&#x52A1;&#x5668;&#x6216;&#x4ECE;&#x5BF9;&#x8C61;&#x670D;&#x52A1;&#x5668;&#x6D41;&#x5F0F;&#x4F20;&#x51FA;&#x65F6;&#xFF0C;&#x5B83;&#x4EEC;&#x76F4;&#x63A5;&#x901A;&#x8FC7;&#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5668;&#x6D41;&#x5165;&#x6216;&#x6D41;&#x51FA;&#x7528;&#x6237; - &#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5668;&#x4E0D;&#x4F1A;&#x5BF9;&#x5B83;&#x4EEC;&#x8FDB;&#x884C;&#x5047;&#x8131;&#x673A;&#xFF08;spool&#xFF09;&#x3002;</p>
<h2 id="the-ring&#xB6;">The Ring<a href="#the-ring" title="Permalink to this headline">&#xB6;</a></h2>
<p>A ring represents a mapping between the names of entities stored on disk and their physical location. There are separate rings for accounts, containers, and one object ring per storage policy. When other components need to perform any operation on an object, container, or account, they need to interact with the appropriate ring to determine its location in the cluster.</p>
<p>&#x73AF;&#x8868;&#x793A;&#x5B58;&#x50A8;&#x5728;&#x78C1;&#x76D8;&#x4E0A;&#x7684;&#x5B9E;&#x4F53;&#x540D;&#x79F0;&#x4E0E;&#x5176;&#x7269;&#x7406;&#x4F4D;&#x7F6E;&#x4E4B;&#x95F4;&#x7684;&#x6620;&#x5C04;&#x3002;&#x6BCF;&#x4E2A;&#x5B58;&#x50A8;&#x7B56;&#x7565;&#x90FD;&#x6709;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x5E10;&#x6237;&#xFF0C;&#x5BB9;&#x5668;&#x548C;&#x5BF9;&#x8C61;&#x73AF;&#x3002;&#x5F53;&#x5176;&#x4ED6;&#x7EC4;&#x4EF6;&#x9700;&#x8981;&#x5BF9; &#x5BF9;&#x8C61;&#xFF0C;&#x5BB9;&#x5668;&#x6216;&#x5E10;&#x6237; &#x6267;&#x884C;&#x4EFB;&#x4F55;&#x64CD;&#x4F5C;&#x65F6;&#xFF0C;&#x4ED6;&#x4EEC;&#x9700;&#x8981;&#x4E0E;&#x76F8;&#x5E94;&#x7684;&#x73AF;&#x8FDB;&#x884C;&#x4EA4;&#x4E92;&#x4EE5;&#x786E;&#x5B9A;&#x5176;&#x5728;&#x7FA4;&#x96C6;&#x4E2D;&#x7684;&#x4F4D;&#x7F6E;&#x3002;</p>
<p>The Ring maintains this mapping using zones, devices, partitions, and replicas. Each partition in the ring is replicated, by default, 3 times across the cluster, and the locations for a partition are stored in the mapping maintained by the ring. The ring is also responsible for determining which devices are used for handoff in failure scenarios.</p>
<p>Ring&#x4F7F;&#x7528;zones&#xFF0C;&#x8BBE;&#x5907;&#xFF0C;&#x5206;&#x533A;&#x548C;&#x526F;&#x672C;&#x6765;&#x7EF4;&#x62A4;&#x6B64;&#x6620;&#x5C04;&#x3002;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x73AF;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x5206;&#x533A;&#x90FD;&#x4F1A;&#x5728;&#x7FA4;&#x96C6;&#x4E2D;&#x590D;&#x5236;3&#x6B21;&#xFF08;&#x8BD1;&#x6CE8;&#xFF1A;&#x590D;&#x5236;&#x6210;3&#x4EFD;&#xFF0C;&#x603B;&#x5171;3&#x4EFD;&#xFF09;&#xFF0C;&#x5E76;&#x4E14;&#x5206;&#x533A;&#x7684;&#x4F4D;&#x7F6E;&#x5C06;&#x5B58;&#x50A8;&#x5728;&#x7531;&#x73AF;&#x7EF4;&#x62A4;&#x7684;&#x6620;&#x5C04;&#x4E2D;&#x3002;&#x73AF;&#x8FD8;&#x8D1F;&#x8D23;&#x786E;&#x5B9A;&#x5728;&#x6545;&#x969C;&#x60C5;&#x51B5;&#x4E0B;&#x54EA;&#x4E9B;&#x8BBE;&#x5907;&#x7528;&#x4E8E;&#x5207;&#x6362;&#x3002;</p>
<p>The replicas of each partition will be isolated onto as many distinct regions, zones, servers and devices as the capacity of these failure domains allow. If there are less failure domains at a given tier than replicas of the partition assigned within a tier (e.g. a 3 replica cluster with 2 servers), or the available capacity across the failure domains within a tier are not well balanced it will not be possible to achieve both even capacity distribution (balance) as well as complete isolation of replicas across failure domains (dispersion). When this occurs the ring management tools will display a warning so that the operator can evaluate the cluster topology.</p>
<p>&#x6BCF;&#x4E2A;&#x5206;&#x533A;&#x7684;&#x526F;&#x672C;&#x5C06;&#x88AB;&#x9694;&#x79BB;&#x5230;&#x5C3D;&#x53EF;&#x80FD;&#x591A;&#x7684;&#x4E0D;&#x540C;regions&#xFF0C;zones&#xFF0C;&#x670D;&#x52A1;&#x5668;&#x548C;&#x8BBE;&#x5907;&#x4E0A;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x4E9B;&#x6545;&#x969C;&#x57DF;&#x7684;&#x5BB9;&#x91CF;&#x5141;&#x8BB8;&#xFF08;&#x8BD1;&#x6CE8;&#xFF1A;&#x8FD9;&#x4E2A;&#x5730;&#x65B9;&#x7FFB;&#x8BD1;&#x5F97;&#x62D7;&#x53E3;&#xFF0C;&#x5176;&#x5B9E;&#x5C31;&#x662F;&#x201C;&#x7531;&#x4E8E;&#x6545;&#x969C;&#x533A;&#x57DF;&#x7684;&#x5141;&#x8BB8;&#x7684;&#x5BB9;&#x91CF;&#x201D;&#xFF09;&#x3002;&#x5982;&#x679C;&#x7ED9;&#x5B9A;&#x5C42;&#x4E0A;&#x7684;&#x6545;&#x969C;&#x57DF;&#x6570;&#x91CF;&#x5C11;&#x4E8E;&#x5C42;&#x5185;&#x5206;&#x914D;&#x7684;&#x5206;&#x533A;&#x7684;&#x526F;&#x672C;&#x6570;&#x91CF;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x5177;&#x6709;2&#x4E2A;&#x670D;&#x52A1;&#x5668;&#x7684;3&#x4E2A;&#x526F;&#x672C;&#x7FA4;&#x96C6;&#xFF09;&#xFF0C;&#x6216;&#x8005;&#x5C42;&#x5185;&#x6545;&#x969C;&#x57DF;&#x7684;&#x53EF;&#x7528;&#x5BB9;&#x91CF;&#x672A;&#x5F97;&#x5230;&#x5F88;&#x597D;&#x7684;&#x5E73;&#x8861;&#xFF0C;&#x5219;&#x65E0;&#x6CD5;&#x5B9E;&#x73B0;&#x5747;&#x5300;&#x7684;&#x5BB9;&#x91CF;&#x5206;&#x914D;&#xFF08;&#x5E73;&#x8861;&#xFF09;&#x4EE5;&#x53CA;&#x8DE8;&#x6545;&#x969C;&#x57DF;&#xFF08;&#x5206;&#x6563;&#x5EA6;dispersion&#xFF09;&#x5B8C;&#x5168;&#x9694;&#x79BB;replicas&#x3002;&#x53D1;&#x751F;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x65F6;&#xFF0C;&#x73AF;&#x7BA1;&#x7406;&#x5DE5;&#x5177;&#x5C06;&#x663E;&#x793A;&#x8B66;&#x544A;&#xFF0C;&#x4EE5;&#x4FBF;&#x64CD;&#x4F5C;&#x5458;&#x53EF;&#x4EE5;&#x8BC4;&#x4F30;&#x96C6;&#x7FA4;&#x62D3;&#x6251;&#x3002;</p>
<p>Data is evenly distributed across the capacity available in the cluster as described by the devices weight. Weights can be used to balance the distribution of partitions on drives across the cluster. This can be useful, for example, when different sized drives are used in a cluster. Device weights can also be used when adding or removing capacity or failure domains to control how many partitions are reassigned during a rebalance to be moved as soon as replication bandwidth allows.</p>
<p>&#x6570;&#x636E;&#x5747;&#x5300;&#x5206;&#x5E03;&#x5728;&#x7FA4;&#x96C6;&#x4E2D;&#x53EF;&#x7528;&#x7684;&#x5BB9;&#x91CF;&#x4E2D;&#xFF0C;&#x5982;&#x8BBE;&#x5907;&#x6743;&#x91CD;&#xFF08;weight&#xFF09;&#x6240;&#x8FF0;&#x3002;&#x6743;&#x91CD;&#x53EF;&#x7528;&#x4E8E;&#x5E73;&#x8861;&#x7FA4;&#x96C6;&#x4E2D;&#x9A71;&#x52A8;&#x5668;&#x4E0A;&#x7684;&#x5206;&#x533A;&#x5206;&#x5E03;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5F53;&#x5728;&#x7FA4;&#x96C6;&#x4E2D;&#x4F7F;&#x7528;&#x4E0D;&#x540C;&#x5927;&#x5C0F;&#x7684;&#x9A71;&#x52A8;&#x5668;&#x65F6;&#xFF0C;&#x8FD9;&#x53EF;&#x80FD;&#x5F88;&#x6709;&#x7528;&#x3002;&#x5728;&#x6DFB;&#x52A0;&#x6216;&#x5220;&#x9664;&#x5BB9;&#x91CF;&#x6216;&#x6545;&#x969C;&#x57DF;&#x65F6;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x8BBE;&#x5907;&#x6743;&#x91CD;&#x6765;&#x63A7;&#x5236;&#x5728;&#x590D;&#x5236;&#x5E26;&#x5BBD;&#x5141;&#x8BB8;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x5728;&#x91CD;&#x65B0;&#x5E73;&#x8861;&#x671F;&#x95F4;&#x91CD;&#x65B0;&#x5206;&#x914D;&#x7684;&#x5206;&#x533A;&#x6570;&#x3002;</p>
<p>Note</p>
<p>Prior to Swift 2.1.0 it was not possible to restrict partition movement by device weight when adding new failure domains, and would allow extremely unbalanced rings. The greedy dispersion algorithm is now subject to the constraints of the physical capacity in the system, but can be adjusted with-in reason via the overload option. Artificially unbalancing the partition assignment without respect to capacity can introduce unexpected full devices when a given failure domain does not physically support its share of the used capacity in the tier.</p>
<p>&#x6CE8;&#x610F;</p>
<p>&#x5728;Swift 2.1.0&#x4E4B;&#x524D;&#xFF0C;&#x5728;&#x6DFB;&#x52A0;&#x65B0;&#x7684;&#x6545;&#x969C;&#x57DF;&#x65F6;&#xFF0C;&#x4E0D;&#x53EF;&#x80FD;&#x901A;&#x8FC7;&#x8BBE;&#x5907;&#x6743;&#x91CD;&#x9650;&#x5236;&#x5206;&#x533A;&#x79FB;&#x52A8;&#xFF0C;&#x5E76;&#x4E14;&#x5141;&#x8BB8;&#x6781;&#x4E0D;&#x5E73;&#x8861;&#x7684;&#x73AF;&#x3002;&#x8D2A;&#x5A6A;&#x7684;&#x5206;&#x6563;&#x5EA6;&#x7B97;&#x6CD5;&#xFF08;greedy dispersion algorithm&#xFF09;&#x73B0;&#x5728;&#x53D7;&#x5236;&#x4E8E;&#x7CFB;&#x7EDF;&#x4E2D;&#x7269;&#x7406;&#x5BB9;&#x91CF;&#x7684;&#x7EA6;&#x675F;&#xFF0C;&#x4F46;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8FC7;&#x8F7D;&#x9009;&#x9879;&#x8FDB;&#x884C;&#x5408;&#x7406;&#x8C03;&#x6574;&#x3002;&#x5728;&#x7ED9;&#x5B9A;&#x7684;&#x6545;&#x969C;&#x57DF;&#x4E0D;&#x80FD;&#x7269;&#x7406;&#x4E0A;&#x652F;&#x6301;&#x5176;&#x5728;&#x5C42;&#x4E2D;&#x4F7F;&#x7528;&#x7684;&#x5BB9;&#x91CF;&#x7684;&#x4EFD;&#x989D;&#x65F6;&#xFF0C;&#x4EBA;&#x4E3A;&#x5730;&#x4E0D;&#x5E73;&#x8861;&#x5206;&#x533A;&#x5206;&#x914D;&#x800C;&#x4E0D;&#x8003;&#x8651;&#x5BB9;&#x91CF;&#x4F1A;&#x5F15;&#x5165;&#x610F;&#x5916;&#x7684;&#x5B8C;&#x6574;&#x8BBE;&#x5907;&#xFF08;unexpected full devices&#xFF09;&#x3002;</p>
<p>When partitions need to be moved around (for example if a device is added to the cluster), the ring ensures that a minimum number of partitions are moved at a time, and only one replica of a partition is moved at a time.</p>
<p>&#x5F53;&#x9700;&#x8981;&#x79FB;&#x52A8;&#x5206;&#x533A;&#x65F6;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x5C06;&#x8BBE;&#x5907;&#x6DFB;&#x52A0;&#x5230;&#x7FA4;&#x96C6;&#x4E2D;&#xFF09;&#xFF0C;&#x73AF;&#x786E;&#x4FDD;&#x4E00;&#x6B21;&#x79FB;&#x52A8;&#x6700;&#x5C11;&#x6570;&#x91CF;&#x7684;&#x5206;&#x533A;&#xFF0C;&#x5E76;&#x4E14;&#x4E00;&#x6B21;&#x53EA;&#x79FB;&#x52A8;&#x4E00;&#x4E2A;&#x5206;&#x533A;&#x7684;&#x4E00;&#x4E2A;&#x526F;&#x672C;&#x3002;</p>
<p>The ring is used by the Proxy server and several background processes (like replication). See <a href="overview_ring.html">The Rings</a> for complete information on the ring.</p>
<p>&#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5668;&#x548C;&#x51E0;&#x4E2A;&#x540E;&#x53F0;&#x8FDB;&#x7A0B;&#xFF08;&#x5982;replication&#xFF09;&#x4F7F;&#x7528;&#x73AF;&#x3002;&#x6709;&#x5173;&#x6212;&#x6307;&#x7684;&#x5B8C;&#x6574;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;<a href="overview_ring.html">The Rings</a>&#x3002;</p>
<h2 id="storage-policies&#xB6;">Storage Policies<a href="#storage-policies" title="Permalink to this headline">&#xB6;</a></h2>
<p>Storage Policies provide a way for object storage providers to differentiate service levels, features and behaviors of a Swift deployment. Each Storage Policy configured in Swift is exposed to the client via an abstract name. Each device in the system is assigned to one or more Storage Policies. This is accomplished through the use of multiple object rings, where each Storage Policy has an independent object ring, which may include a subset of hardware implementing a particular differentiation.</p>
<p>&#x5B58;&#x50A8;&#x7B56;&#x7565;&#x4E3A;&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x63D0;&#x4F9B;&#x8005;&#xFF08;object storage providers&#xFF09;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x79CD;&#x533A;&#x5206;Swift&#x90E8;&#x7F72;&#x7684;&#x670D;&#x52A1;&#x7EA7;&#x522B;&#xFF0C;&#x529F;&#x80FD;&#x548C;&#x884C;&#x4E3A;&#x7684;&#x65B9;&#x6CD5;&#x3002;Swift&#x4E2D;&#x914D;&#x7F6E;&#x7684;&#x6BCF;&#x4E2A;&#x5B58;&#x50A8;&#x7B56;&#x7565;&#x90FD;&#x901A;&#x8FC7;&#x62BD;&#x8C61;&#x540D;&#x79F0;&#x516C;&#x5F00;&#x7ED9;&#x5BA2;&#x6237;&#x7AEF;&#x3002;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x8BBE;&#x5907;&#x90FD;&#x5206;&#x914D;&#x7ED9;&#x4E00;&#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5B58;&#x50A8;&#x7B56;&#x7565;&#x3002;&#x8FD9;&#x662F;&#x901A;&#x8FC7;&#x4F7F;&#x7528;&#x591A;&#x4E2A;&#x5BF9;&#x8C61;&#x73AF;&#x6765;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x5176;&#x4E2D;&#x6BCF;&#x4E2A;&#x5B58;&#x50A8;&#x7B56;&#x7565;&#x5177;&#x6709;&#x72EC;&#x7ACB;&#x7684;&#x5BF9;&#x8C61;&#x73AF;&#xFF0C;&#x5176;&#x53EF;&#x4EE5;&#x5305;&#x62EC;&#x5B9E;&#x73B0;&#x7279;&#x5B9A;&#x533A;&#x5206;&#x7684;&#x786C;&#x4EF6;&#x5B50;&#x96C6;&#x3002;</p>
<p>&#xFF08;&#x8BD1;&#x6CE8;&#xFF1A;&#x6BCF;&#x4E00;&#x4E2A; device &#x90FD;&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x4E2A;&#x5B58;&#x50A8;&#x7B56;&#x7565;&#x3002;&#x6BCF;&#x4E00;&#x4E2A;&#x5B58;&#x50A8;&#x7B56;&#x7565;&#x90FD;&#x5BF9;&#x5E94;&#x4E8E;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x73AF;&#xFF08;&#x4E0D;&#x662F;&#x5BB9;&#x5668;&#x73AF;&#xFF0C;&#x4E0D;&#x662F;&#x8D26;&#x6237;&#x73AF;&#xFF09;&#xFF0C;&#x4F46;&#x662F;&#xFF0C;&#x540E;&#x6587;&#x77E5;&#x9053;&#xFF0C;&#x8FD9;&#x4E2A;&#x5B58;&#x50A8;&#x7B56;&#x7565;&#x66F4;&#x591A;&#x7684;&#x662F;&#x4E0E;&#x5BB9;&#x5668;&#x73AF;&#x76F8;&#x5173;&#x8054;&#xFF0C;&#x5728;&#x521B;&#x5EFA;&#x5BB9;&#x5668;&#x65F6;&#xFF0C;&#x5B9A;&#x4E49;&#x597D;&#x5B58;&#x50A8;&#x7B56;&#x7565;&#xFF0C;&#x7136;&#x540E;&#x5BB9;&#x5668;&#x5185;&#x7684;&#x5BF9;&#x8C61;&#x6839;&#x636E;&#x8BE5;&#x5B9A;&#x4E49;&#x7B56;&#x7565;&#x6765;&#x5B58;&#x50A8;&#x3002;&#xFF09;</p>
<p>For example, one might have the default policy with 3x replication, and create a second policy which, when applied to new containers only uses 2x replication. Another might add SSDs to a set of storage nodes and create a performance tier storage policy for certain containers to have their objects stored there. Yet another might be the use of Erasure Coding to define a cold-storage tier.</p>
<p>&#x4F8B;&#x5982;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5177;&#x6709;3x&#x590D;&#x5236;&#x7684;&#x9ED8;&#x8BA4;&#x7B56;&#x7565;&#xFF0C;&#x5E76;&#x521B;&#x5EFA;&#x7B2C;&#x4E8C;&#x4E2A;&#x7B56;&#x7565;&#xFF0C;&#x5F53;&#x5E94;&#x7528;&#x4E8E;&#x65B0;&#x5BB9;&#x5668;&#x65F6;&#xFF0C;&#x4EC5;&#x4F7F;&#x7528;2x&#x590D;&#x5236;&#x3002;&#x53E6;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x5C06;SSD&#x6DFB;&#x52A0;&#x5230;&#x4E00;&#x7EC4;&#x5B58;&#x50A8;&#x8282;&#x70B9;&#xFF0C;&#x5E76;&#x4E3A;&#x67D0;&#x4E9B;&#x5BB9;&#x5668;&#x521B;&#x5EFA;&#x6027;&#x80FD;&#x5C42;&#x5B58;&#x50A8;&#x7B56;&#x7565;&#xFF0C;&#x4EE5;&#x5C06;&#x5176;&#x5BF9;&#x8C61;&#x5B58;&#x50A8;&#x5728;&#x90A3;&#x91CC;&#x3002;&#x53E6;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF0C;&#x53EF;&#x80FD;&#x662F;&#x4F7F;&#x7528;Erasure Coding&#x6765;&#x5B9A;&#x4E49;&#x51B7;&#x5B58;&#x50A8;&#x5C42;&#x3002;</p>
<p>This mapping is then exposed on a per-container basis, where each container can be assigned a specific storage policy when it is created, which remains in effect for the lifetime of the container. Applications require minimal awareness of storage policies to use them; once a container has been created with a specific policy, all objects stored in it will be done so in accordance with that policy.</p>
<p>&#x7136;&#x540E;&#xFF0C;&#x57FA;&#x4E8E;&#x6BCF;&#x4E2A;&#x5BB9;&#x5668;&#x516C;&#x5F00;&#x6B64;&#x6620;&#x5C04;&#xFF0C;&#x5176;&#x4E2D;&#x6BCF;&#x4E2A;&#x5BB9;&#x5668;&#x5728;&#x521B;&#x5EFA;&#x65F6;&#x90FD;&#x53EF;&#x4EE5;&#x5206;&#x914D;&#x7279;&#x5B9A;&#x7684;&#x5B58;&#x50A8;&#x7B56;&#x7565;&#xFF0C;&#x8BE5;&#x7B56;&#x7565;&#x5728;&#x5BB9;&#x5668;&#x7684;&#x751F;&#x547D;&#x5468;&#x671F;&#x5185;&#x4FDD;&#x6301;&#x6709;&#x6548;&#x3002;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x5F88;&#x5C11;&#x7684;&#x5B58;&#x50A8;&#x7B56;&#x7565;&#x610F;&#x8BC6;&#x624D;&#x80FD;&#x4F7F;&#x7528;&#x5B83;&#x4EEC;; &#x4E00;&#x65E6;&#x4F7F;&#x7528;&#x7279;&#x5B9A;&#x7B56;&#x7565;&#x521B;&#x5EFA;&#x4E86;&#x5BB9;&#x5668;&#xFF0C;&#x5219;&#x5B58;&#x50A8;&#x5728;&#x5176;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x5BF9;&#x8C61;&#x5C06;&#x6839;&#x636E;&#x8BE5;&#x7B56;&#x7565;&#x5B8C;&#x6210;&#x3002;</p>
<p>The Storage Policies feature is implemented throughout the entire code base so it is an important concept in understanding Swift architecture.</p>
<p>&#x5B58;&#x50A8;&#x7B56;&#x7565;&#x529F;&#x80FD;&#x5728;&#x6574;&#x4E2A;&#x4EE3;&#x7801;&#x5E93;&#x4E2D;&#x5B9E;&#x73B0;&#xFF0C;&#x56E0;&#x6B64;&#x5B83;&#x662F;&#x7406;&#x89E3;Swift&#x4F53;&#x7CFB;&#x7ED3;&#x6784;&#x7684;&#x91CD;&#x8981;&#x6982;&#x5FF5;&#x3002;</p>
<p>See <a href="overview_policies.html">Storage Policies</a> for complete information on storage policies.</p>
<p>&#x6709;&#x5173;&#x5B58;&#x50A8;&#x7B56;&#x7565;&#x7684;&#x5B8C;&#x6574;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x5B58;&#x50A8;&#x7B56;&#x7565;&#x3002;</p>
<h2 id="object-server&#xB6;">Object Server<a href="#object-server" title="Permalink to this headline">&#xB6;</a></h2>
<p>The Object Server is a very simple blob storage server that can store, retrieve and delete objects stored on local devices. Objects are stored as binary files on the filesystem with metadata stored in the file&#x2019;s extended attributes (xattrs). This requires that the underlying filesystem choice for object servers support xattrs on files. Some filesystems, like ext3, have xattrs turned off by default.</p>
<p>&#x5BF9;&#x8C61;&#x670D;&#x52A1;&#xFF08;Object Server&#xFF09;&#x662F;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x7B80;&#x5355;&#x7684;blob&#x5B58;&#x50A8;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x53EF;&#x4EE5;&#x5B58;&#x50A8;&#xFF0C;&#x68C0;&#x7D22;&#x548C;&#x5220;&#x9664;&#x5B58;&#x50A8;&#x5728;&#x672C;&#x5730;&#x8BBE;&#x5907;&#x4E0A;&#x7684;&#x5BF9;&#x8C61;&#x3002;&#x5BF9;&#x8C61;&#x4F5C;&#x4E3A;&#x4E8C;&#x8FDB;&#x5236;&#x6587;&#x4EF6;&#x5B58;&#x50A8;&#x5728;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E2D;&#xFF0C;&#x5143;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x5728;&#x6587;&#x4EF6;&#x7684;&#x6269;&#x5C55;&#x5C5E;&#x6027;&#xFF08;xattrs&#xFF09;&#x4E2D;&#xFF08;&#x8BD1;&#x6CE8;&#xFF1A;&#x6240;&#x4EE5;&#xFF0C;&#x5F53;&#x4F60;&#x5728;&#x627E;&#x5230;&#x4E86;&#x5BF9;&#x8C61;&#x540E;&#xFF0C;&#x4EC5;&#x901A;&#x8FC7;<code>ls -l</code>&#x8FD9;&#x6837;&#x7684;&#x547D;&#x4EE4;&#x662F;&#x770B;&#x4E0D;&#x5230;&#x5BF9;&#x8C61;&#x5143;&#x6570;&#x636E;&#x7684;&#xFF09;&#x3002;&#x8FD9;&#x8981;&#x6C42;&#x5BF9;&#x8C61;&#x670D;&#x52A1;&#x5668;&#x7684;&#x57FA;&#x7840;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x9009;&#x62E9;&#x652F;&#x6301;&#x6587;&#x4EF6;&#x4E0A;&#x7684;xattrs&#x3002;&#x67D0;&#x4E9B;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF08;&#x5982;ext3&#xFF09;&#x9ED8;&#x8BA4;&#x5173;&#x95ED;xattrs&#x3002;</p>
<p>Each object is stored using a path derived from the object name&#x2019;s hash and the operation&#x2019;s timestamp. Last write always wins, and ensures that the latest object version will be served. A deletion is also treated as a version of the file (a 0 byte file ending with &#x201C;.ts&#x201D;, which stands for tombstone). This ensures that deleted files are replicated correctly and older versions don&#x2019;t magically reappear .</p>
<p>&#x4F7F;&#x7528;&#x4ECE;&#x5BF9;&#x8C61;&#x540D;&#x79F0;&#x7684;hash&#x548C;&#x64CD;&#x4F5C;&#x7684;&#x65F6;&#x95F4;&#x6233;&#x6D3E;&#x751F;&#x7684;&#x8DEF;&#x5F84;&#x5B58;&#x50A8;&#x6BCF;&#x4E2A;&#x5BF9;&#x8C61;&#x3002;&#x4E0A;&#x6B21;&#x5199;&#x5165;&#x603B;&#x662F;&#x83B7;&#x80DC;&#xFF0C;&#x5E76;&#x786E;&#x4FDD;&#x5C06;&#x63D0;&#x4F9B;&#x6700;&#x65B0;&#x7684;&#x5BF9;&#x8C61;&#x7248;&#x672C;&#xFF08;&#x8BD1;&#x6CE8;&#xFF1A;&#x8FD9;&#x91CC;&#x53EA;&#x662F;&#x786E;&#x4FDD;&#x63D0;&#x4F9B;&#x6700;&#x65B0;&#xFF0C;&#x4E0D;&#x662F;&#x4E00;&#x5B9A;&#x63D0;&#x4F9B;&#x6700;&#x65B0;&#xFF0C;&#x8FD9;&#x4E5F;&#x662F;&#x6700;&#x7EC8;&#x4E00;&#x81F4;&#x6027;&#x7684;&#x4F53;&#x73B0;&#x3002;&#x5982;&#xFF0C;&#x5199;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x540E;&#xFF0C;&#x5E76;&#x4E0D;&#x4E00;&#x5B9A;&#x9A6C;&#x4E0A;&#xFF08;&#x6BD4;&#x5982;&#x4E0B;&#x4E00;&#x79D2;&#x949F;&#xFF09;&#xFF0C;&#x5C31;&#x5F97;&#x5230;&#x8FD9;&#x4E2A;&#x6700;&#x65B0;&#x7684;&#x5199;&#x5165;&#x6570;&#x636E;&#xFF0C;&#x4F46;&#x662F;&#xFF0C;5&#x5206;&#x949F;&#x540E;&#xFF0C;&#x5C31;&#x4E00;&#x5B9A;&#x80FD;&#x5F97;&#x5230;&#x8FD9;&#x4E2A;&#x6700;&#x65B0;&#x7684;&#x5199;&#x5165;&#x6570;&#x636E;&#xFF09;&#x3002;&#x5220;&#x9664;&#x4E5F;&#x88AB;&#x89C6;&#x4E3A;&#x6587;&#x4EF6;&#x7684;&#x4E00;&#x4E2A;&#x7248;&#x672C;&#xFF08;&#x4E00;&#x4E2A;&#x4EE5;&#x201C;.ts&#x201D;&#x7ED3;&#x5C3E;&#x7684;0&#x5B57;&#x8282;&#x6587;&#x4EF6;&#xFF0C;&#x4EE3;&#x8868;&#x5893;&#x7891;tombstone&#xFF09;&#x3002;&#x8FD9;&#x53EF;&#x786E;&#x4FDD;&#x6B63;&#x786E;&#x590D;&#x5236;&#x5DF2;&#x5220;&#x9664;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x65E7;&#x7248;&#x672C;&#x4E0D;&#x4F1A;&#x795E;&#x5947;&#x5730;&#x91CD;&#x65B0;&#x51FA;&#x73B0; due to failure scenarios&#x3002;</p>
<h2 id="container-server&#xB6;">Container Server<a href="#container-server" title="Permalink to this headline">&#xB6;</a></h2>
<p>The Container Server&#x2019;s primary job is to handle listings of objects. It doesn&#x2019;t know where those object&#x2019;s are, just what objects are in a specific container. The listings are stored as sqlite database files, and replicated across the cluster similar to how objects are. Statistics are also tracked that include the total number of objects, and total storage usage for that container.</p>
<p>Container Server&#x7684;&#x4E3B;&#x8981;&#x5DE5;&#x4F5C;&#x662F;&#x5904;&#x7406;&#x5BF9;&#x8C61;&#x5217;&#x8868;&#x3002;&#x5B83;&#x4E0D;&#x77E5;&#x9053;&#x90A3;&#x4E9B;&#x5BF9;&#x8C61;&#x5728;&#x54EA;&#x91CC;&#xFF0C;&#x53EA;&#x77E5;&#x9053;&#x7279;&#x5B9A;&#x5BB9;&#x5668;&#x4E2D;&#x7684;&#x5BF9;&#x8C61;&#x3002;&#x5217;&#x8868;&#x5B58;&#x50A8;&#x4E3A;sqlite&#x6570;&#x636E;&#x5E93;&#x6587;&#x4EF6;&#xFF0C;&#x5E76;&#x5728;&#x96C6;&#x7FA4;&#x4E2D;&#x590D;&#x5236;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E;&#x5BF9;&#x8C61;&#x7684;&#x65B9;&#x5F0F;&#x3002;&#x8FD8;&#x4F1A;&#x8DDF;&#x8E2A;&#x7EDF;&#x8BA1;&#x4FE1;&#x606F;&#xFF0C;&#x5176;&#x4E2D;&#x5305;&#x62EC;&#x5BF9;&#x8C61;&#x603B;&#x6570;&#x4EE5;&#x53CA;&#x8BE5;&#x5BB9;&#x5668;&#x7684;&#x603B;&#x5B58;&#x50A8;&#x4F7F;&#x7528;&#x60C5;&#x51B5;&#x3002;</p>
<h2 id="account-server&#xB6;">Account Server<a href="#account-server" title="Permalink to this headline">&#xB6;</a></h2>
<p>The Account Server is very similar to the Container Server, excepting that it is responsible for listings of containers rather than objects.</p>
<p>Account Server&#x4E0E;Container&#x670D;&#x52A1;&#x975E;&#x5E38;&#x76F8;&#x4F3C;&#xFF0C;&#x4E0D;&#x540C;&#x4E4B;&#x5904;&#x5728;&#x4E8E;&#x5B83;&#x8D1F;&#x8D23;&#x5BB9;&#x5668;&#x800C;&#x4E0D;&#x662F;&#x5BF9;&#x8C61;&#x7684;&#x5217;&#x8868;&#x3002;</p>
<h2 id="replication&#xB6;">Replication<a href="#replication" title="Permalink to this headline">&#xB6;</a></h2>
<p>Replication is designed to keep the system in a consistent state in the face of temporary error conditions like network outages or drive failures.</p>
<p>&#x590D;&#x5236;&#x65E8;&#x5728;&#x4F7F;&#x7CFB;&#x7EDF;&#x5728;&#x9762;&#x4E34;&#x7F51;&#x7EDC;&#x4E2D;&#x65AD;&#x6216;&#x9A71;&#x52A8;&#x5668;&#x6545;&#x969C;&#x7B49;&#x4E34;&#x65F6;&#x9519;&#x8BEF;&#x60C5;&#x51B5;&#x65F6;&#x4FDD;&#x6301;&#x4E00;&#x81F4;&#x72B6;&#x6001;&#x3002;</p>
<p>The replication processes compare local data with each remote copy to ensure they all contain the latest version. Object replication uses a hash list to quickly compare subsections of each partition, and container and account replication use a combination of hashes and shared high water marks.</p>
<p>&#x590D;&#x5236;&#x8FC7;&#x7A0B;&#x5C06;&#x672C;&#x5730;&#x6570;&#x636E;&#x4E0E;&#x6BCF;&#x4E2A;&#x8FDC;&#x7A0B;&#x526F;&#x672C;&#x8FDB;&#x884C;&#x6BD4;&#x8F83;&#xFF0C;&#x4EE5;&#x786E;&#x4FDD;&#x5B83;&#x4EEC;&#x90FD;&#x5305;&#x542B;&#x6700;&#x65B0;&#x7248;&#x672C;&#x3002;&#x5BF9;&#x8C61;&#x590D;&#x5236;&#x4F7F;&#x7528;&#x54C8;&#x5E0C;&#x5217;&#x8868;&#x5FEB;&#x901F;&#x6BD4;&#x8F83;&#x6BCF;&#x4E2A;&#x5206;&#x533A;&#x7684;&#x5B50;&#x90E8;&#x5206;&#xFF0C;&#x5BB9;&#x5668;&#x548C;&#x5E10;&#x6237;&#x590D;&#x5236;&#x4F7F;&#x7528;&#x54C8;&#x5E0C;&#x548C;&#x5171;&#x4EAB;&#x9AD8;&#x6C34;&#x4F4D;&#x6807;&#x8BB0;&#x7684;&#x7EC4;&#x5408;&#x3002;</p>
<p>Replication updates are push based. For object replication, updating is just a matter of rsyncing files to the peer. Account and container replication push missing records over HTTP or rsync whole database files.</p>
<p>&#x590D;&#x5236;&#x66F4;&#x65B0;&#x662F;&#x57FA;&#x4E8E;&#x63A8;&#x9001;&#x7684;&#x3002;&#x5BF9;&#x4E8E;&#x5BF9;&#x8C61;&#x590D;&#x5236;&#xFF0C;&#x66F4;&#x65B0;&#x53EA;&#x662F;&#x5C06;&#x6587;&#x4EF6;&#x53D1;&#x9001;&#x5230;&#x5BF9;&#x7B49;&#x65B9;&#x7684;&#x4E8B;&#x4EF6;&#x3002;&#x5E10;&#x6237;&#x548C;&#x5BB9;&#x5668;&#x590D;&#x5236;&#x901A;&#x8FC7;HTTP&#x6216;rsync&#x63A8;&#x9001;&#x6574;&#x4E2A;&#x6570;&#x636E;&#x5E93;&#x6587;&#x4EF6;&#x4E22;&#x5931;&#x7684;&#x8BB0;&#x5F55;&#x3002;</p>
<p>The replicator also ensures that data is removed from the system. When an item (object, container, or account) is deleted, a tombstone is set as the latest version of the item. The replicator will see the tombstone and ensure that the item is removed from the entire system.</p>
<p>&#x590D;&#x5236;&#x5668;(replicator)&#x8FD8;&#x786E;&#x4FDD;&#x4ECE;&#x7CFB;&#x7EDF;&#x4E2D;&#x5220;&#x9664;&#x6570;&#x636E;&#x3002;&#x5220;&#x9664;&#x9879;&#x76EE;&#xFF08;&#x5BF9;&#x8C61;&#xFF0C;&#x5BB9;&#x5668;&#x6216;&#x5E10;&#x6237;&#xFF09;&#x65F6;&#xFF0C;&#x4F1A;&#x5C06;&#x903B;&#x8F91;&#x5220;&#x9664;&#x8BBE;&#x7F6E;&#x4E3A;&#x9879;&#x76EE;&#x7684;&#x6700;&#x65B0;&#x7248;&#x672C;&#x3002;&#x590D;&#x5236;&#x5668;&#x5C06;&#x770B;&#x5230;&#x5893;&#x7891;&#xFF0C;&#x5E76;&#x786E;&#x4FDD;&#x4ECE;&#x6574;&#x4E2A;&#x7CFB;&#x7EDF;&#x4E2D;&#x5220;&#x9664;&#x8BE5;&#x9879;&#x76EE;&#x3002;</p>
<p>See <a href="overview_replication.html">Replication</a> for complete information on replication.</p>
<p>&#x6709;&#x5173;&#x590D;&#x5236;&#x7684;&#x5B8C;&#x6574;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x89C1;<a href="overview_replication.html">Replication</a>&#x3002;</p>
<h2 id="reconstruction&#xB6;">Reconstruction<a href="#reconstruction" title="Permalink to this headline">&#xB6;</a></h2>
<p>The reconstructor is used by Erasure Code policies and is analogous to the replicator for Replication type policies. See <a href="overview_erasure_code.html">Erasure Code Support</a> for complete information on both Erasure Code support as well as the reconstructor.</p>
<p>&#x91CD;&#x6784;&#x5668;&#xFF08;reconstructor&#xFF09;&#x7531;Erasure Code&#x7B56;&#x7565;&#x4F7F;&#x7528;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E;&#x590D;&#x5236;&#x7C7B;&#x578B;&#x7B56;&#x7565;&#x7684;&#x590D;&#x5236;&#x5668;&#x3002;&#x6709;&#x5173;Erasure Code&#x652F;&#x6301; &#x4EE5;&#x53CA;&#x91CD;&#x5EFA;&#x5668;&#x7684;&#x5B8C;&#x6574;&#x4FE1;&#x606F;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;<a href="overview_erasure_code.html">Erasure Code Support</a>&#x3002;</p>
<h2 id="updaters&#xB6;">Updaters<a href="#updaters" title="Permalink to this headline">&#xB6;</a></h2>
<p>There are times when container or account data can not be immediately updated. This usually occurs during failure scenarios or periods of high load. If an update fails, the update is queued locally on the filesystem, and the updater will process the failed updates. This is where an eventual consistency window will most likely come in to play. For example, suppose a container server is under load and a new object is put in to the system. The object will be immediately available for reads as soon as the proxy server responds to the client with success. However, the container server did not update the object listing, and so the update would be queued for a later update. Container listings, therefore, may not immediately contain the object.</p>
<p>&#x6709;&#x65F6;&#x65E0;&#x6CD5;&#x7ACB;&#x5373;&#x66F4;&#x65B0;&#x5BB9;&#x5668;&#x6216;&#x5E10;&#x6237;&#x6570;&#x636E;&#x3002;&#x8FD9;&#x901A;&#x5E38;&#x53D1;&#x751F;&#x5728;&#x6545;&#x969C;&#x60C5;&#x51B5;&#x6216;&#x9AD8;&#x8D1F;&#x8F7D;&#x671F;&#x95F4;&#x3002;&#x5982;&#x679C;&#x66F4;&#x65B0;&#x5931;&#x8D25;&#xFF0C;&#x5219;&#x66F4;&#x65B0;&#x5C06;&#x5728;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E0A;&#x672C;&#x5730;&#x6392;&#x961F;&#xFF0C;&#x66F4;&#x65B0;&#x7A0B;&#x5E8F;&#x5C06;&#x5904;&#x7406;&#x5931;&#x8D25;&#x7684;&#x66F4;&#x65B0;&#x3002;&#x8FD9;&#x662F;&#x6700;&#x6709;&#x53EF;&#x80FD;&#x8FDB;&#x5165;&#x6700;&#x7EC8;&#x4E00;&#x81F4;&#x6027;&#x7A97;&#x53E3;&#xFF08;an eventual consistency window&#xFF09;&#x7684;&#x5730;&#x65B9;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5047;&#x8BBE;&#x5BB9;&#x5668;&#x670D;&#x52A1;&#x5668;&#x5904;&#x4E8E;&#x8D1F;&#x8F7D;&#x72B6;&#x6001;&#xFF0C;&#x5E76;&#x4E14;&#x65B0;&#x5BF9;&#x8C61;&#x88AB;&#x653E;&#x5165;&#x7CFB;&#x7EDF;&#x3002;&#x4E00;&#x65E6;&#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5668;&#x6210;&#x529F;&#x54CD;&#x5E94;&#x5BA2;&#x6237;&#x7AEF;&#xFF0C;&#x8BE5;&#x5BF9;&#x8C61;&#x5C06;&#x7ACB;&#x5373;&#x53EF;&#x7528;&#x4E8E;&#x8BFB;&#x53D6;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5BB9;&#x5668;&#x670D;&#x52A1;&#x5668;&#x672A;&#x66F4;&#x65B0;&#x5BF9;&#x8C61;&#x5217;&#x8868;&#xFF0C;&#x56E0;&#x6B64;&#x66F4;&#x65B0;&#x5C06;&#x6392;&#x961F;&#x7B49;&#x5F85;&#x4EE5;&#x540E;&#x7684;&#x66F4;&#x65B0;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x5BB9;&#x5668;&#x5217;&#x8868;&#x53EF;&#x80FD;&#x4E0D;&#x4F1A;&#x7ACB;&#x5373;&#x5305;&#x542B;&#x8BE5;&#x5BF9;&#x8C61;&#x3002;</p>
<p>In practice, the consistency window is only as large as the frequency at which the updater runs and may not even be noticed as the proxy server will route listing requests to the first container server which responds. The server under load may not be the one that serves subsequent listing requests &#x2013; one of the other two replicas may handle the listing.</p>
<p>&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x4E00;&#x81F4;&#x6027;&#x7A97;&#x53E3;&#x4EC5;&#x4E0E;&#x66F4;&#x65B0;&#x7A0B;&#x5E8F;&#x8FD0;&#x884C;&#x7684;&#x9891;&#x7387;&#x4E00;&#x6837;&#x5927;&#xFF0C;&#x751A;&#x81F3;&#x53EF;&#x80FD;&#x6CA1;&#x6709;&#x88AB;&#x6CE8;&#x610F;&#x5230;&#xFF0C;&#x56E0;&#x4E3A;&#x4EE3;&#x7406;&#x670D;&#x52A1;&#x5668;&#x5C06;&#x5217;&#x8868;&#x8BF7;&#x6C42;&#x8DEF;&#x7531;&#x5230;&#x54CD;&#x5E94;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x5BB9;&#x5668;&#x670D;&#x52A1;&#x5668;&#x3002;&#x52A0;&#x8F7D;&#x7684;&#x670D;&#x52A1;&#x5668;&#x53EF;&#x80FD;&#x4E0D;&#x662F;&#x670D;&#x52A1;&#x540E;&#x7EED;&#x5217;&#x8868;&#x8BF7;&#x6C42;&#x7684;&#x670D;&#x52A1;&#x5668; - &#x53E6;&#x5916;&#x4E24;&#x4E2A;&#x526F;&#x672C;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x53EF;&#x4EE5;&#x5904;&#x7406;&#x5217;&#x8868;&#x3002;</p>
<h2 id="auditors&#xB6;">Auditors<a href="#auditors" title="Permalink to this headline">&#xB6;</a></h2>
<p>Auditors crawl the local server checking the integrity of the objects, containers, and accounts. If corruption is found (in the case of bit rot, for example), the file is quarantined, and replication will replace the bad file from another replica. If other errors are found they are logged (for example, an object&#x2019;s listing can&#x2019;t be found on any container server it should be).</p>
<p>&#x5BA1;&#x8BA1;&#x5458;&#x6293;&#x53D6;&#x672C;&#x5730;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x68C0;&#x67E5;&#x5BF9;&#x8C61;&#xFF0C;&#x5BB9;&#x5668;&#x548C;&#x5E10;&#x6237;&#x7684;&#x5B8C;&#x6574;&#x6027;&#x3002;&#x5982;&#x679C;&#x53D1;&#x73B0;&#x635F;&#x574F;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x5728;&#x53D1;&#x751F;&#x635F;&#x574F;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF09;&#xFF0C;&#x5219;&#x4F1A;&#x9694;&#x79BB;&#x8BE5;&#x6587;&#x4EF6;&#xFF0C;&#x5E76;&#x4E14;&#x5C06;&#x4ECE;&#x53E6;&#x4E00;&#x4E2A;&#x526F;&#x672C;&#x590D;&#x5236;&#x66FF;&#x6362;&#x8BE5;&#x9519;&#x8BEF;&#x6587;&#x4EF6;&#x3002;&#x5982;&#x679C;&#x53D1;&#x73B0;&#x5176;&#x4ED6;&#x9519;&#x8BEF;&#xFF0C;&#x5219;&#x4F1A;&#x8BB0;&#x5F55;&#x5B83;&#x4EEC;&#xFF08;&#x4F8B;&#x5982;&#xFF0C;&#x5728;&#x4EFB;&#x4F55;&#x5BB9;&#x5668;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x90FD;&#x627E;&#x4E0D;&#x5230;&#x5BF9;&#x8C61;&#x7684;&#x5217;&#x8868;&#xFF09;&#x3002;</p>
<p>updated: 2019-02-14 02:34</p>
<footer class="page-footer"><span class="copyright"><p><a href="https://github.com/eiuapp/swift-handbook" target="_blank">Openstack Swift&#x5B9E;&#x8DF5;&#x6307;&#x5357;</a> | <a href="https://github.com/eiuapp/swift-handbook" target="_blank">Openstack Swift&#x5B9E;&#x8DF5;&#x6307;&#x5357;</a></p><p><a href="https://res.cloudinary.com/dmtixvmgt/image/upload/v1539022273/wechat-qrcode_cml5dm.jpg" data-lightbox="2fd927ee-fa64-4eca-8ed5-6bd72b573a3c" target="_blank">&#x70B9;&#x51FB;&#x5173;&#x6CE8;&#x3010;servicemesher&#x3011;&#x516C;&#x4F17;&#x53F7;&#x56DE;&#x590D;&#x3010;&#x52A0;&#x7FA4;&#x3011;&#x52A0;&#x5165;&#x5B66;&#x4E60;&#x7FA4;</a> | </p>Copyright &#xA9; <a href="https://eiu.app" target="_blank">eiu.app</a> 2017-2019 all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification"> Updated at 
2019-02-19 14:58:02
</span></footer></body></html>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="api/object_api_v1_overview.html" class="navigation navigation-prev " aria-label="Previous page: Object Storage API overview">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="overview_rings.html" class="navigation navigation-next " aria-label="Next page: The Rings">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Swift Architectural Overview","level":"4.2","depth":1,"next":{"title":"The Rings","level":"4.3","depth":1,"path":"docs/overview_rings.md","ref":"docs/overview_rings.md","articles":[]},"previous":{"title":"Object Storage API overview","level":"4.1","depth":1,"path":"docs/api/object_api_v1_overview.md","ref":"docs/api/object_api_v1_overview.md","articles":[]},"dir":"ltr"},"config":{"plugins":["github","codesnippet","splitter","page-toc-button","editlink","back-to-top-button","-lunr","-search","search-plus","github-buttons@2.1.0","favicon@^0.0.2","tbfed-pagefooter@^0.0.1","3-ba","theme-default","-highlight","prism","prism-themes","sitemap-general","lightbox","adsense","ga"],"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"<p><a href=https://github.com/eiuapp/swift-handbook>Openstack Swift实践指南</a> | <a href=https://github.com/eiuapp/swift-handbook>Openstack Swift实践指南</a></p><p><a href=https://res.cloudinary.com/dmtixvmgt/image/upload/v1539022273/wechat-qrcode_cml5dm.jpg data-lightbox=2fd927ee-fa64-4eca-8ed5-6bd72b573a3c>点击关注【servicemesher】公众号回复【加群】加入学习群</a> | </p>Copyright © <a href=https://eiu.app>eiu.app</a> 2017-2019","modify_label":" Updated at ","modify_format":"YYYY-MM-DD HH:mm:ss"},"prism":{"lang":{"shell":"bash"},"css":["prism-themes/themes/prism-ghcolors.css"]},"github":{"url":"https://github.com/eiuapp/swift-docs"},"editlink":{"label":"编辑本页","multilingual":false,"base":"https://github.com/eiuapp/swift-docs/blob/master/"},"splitter":{},"adsense":{"client":"ca-pub-4029167986768912","slot":"2445941692","format":"auto","element":".page-inner section","position":"bottom"},"codesnippet":{},"sitemap-general":{"prefix":"https://eiu.app/swift-docs/"},"fontsettings":{"theme":"white","family":"sans","size":2},"favicon":{"shortcut":"favicon.ico","bookmark":"favicon.ico"},"lightbox":{"jquery":true},"page-toc-button":{},"back-to-top-button":{},"prism-themes":{},"github-buttons":{"repo":"eiuapp/swift-docs","types":["star"],"size":"small"},"3-ba":{"configuration":"auto","token":"11f7d254cfa4e0ca44b175c66d379ecc"},"ga":{"configuration":"auto","token":"UA-93485976-1"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"showLevel":true,"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"}},"search-plus":{}},"theme":"default","author":"Donald Tsang（圆月弯刀）","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Swift Docs - Swift 官方文档阅读 by Donald Tsang(圆月弯刀)","language":"zh-hans","links":{"sidebar":{"Donald Tsang":"https://b.qqbb.app","Swift Docs":"https://eiu.app/swift-docs"}},"gitbook":"*","description":"Swift Docs - Swift 官方文档阅读 2019年 by Donald Tsang(圆月弯刀) "},"file":{"path":"docs/overview_architecture.md","mtime":"2019-02-19T14:58:02.748Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-02-19T14:59:10.426Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-page-toc-button/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-editlink/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github-buttons/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-3-ba/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lightbox/jquery.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lightbox/lightbox.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-adsense/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

